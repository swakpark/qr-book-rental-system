<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ë„ì„œê´€ ì„œë¹„ìŠ¤</title>
    <style>
        body{font-family:system-ui,-apple-system,BlinkMacSystemFont;background:#f5f6f8;margin:0;padding:20px;}
        .wrap{max-width:420px;margin:0 auto;}
        .card{background:#fff;border-radius:14px;padding:18px;margin-bottom:14px;box-shadow:0 8px 24px rgba(0,0,0,.06);}
        h1{font-size:20px;margin:0 0 8px;}
        .muted{color:#666;font-size:14px;}
        .btn{display:block;width:100%;padding:14px 16px;border-radius:12px;border:0;font-size:16px;margin-top:10px;cursor:pointer;}
        .primary{background:#2563eb;color:#fff;}
        .gray{background:#eef2ff;color:#1e3a8a;}
        .outline{background:#fff;border:1px solid #d1d5db;color:#374151}
        .loan{padding:10px 0;border-top:1px solid #eee;}
        a{text-decoration:none;}
    </style>
</head>
<body>
<div class="wrap">

    <div class="card">
        <h1>ğŸ›ï¸ ë„ì„œê´€ ì„œë¹„ìŠ¤</h1>

        <!-- ë¡œê·¸ì¸/ë¹„ë¡œê·¸ì¸ ì•ˆë‚´ ë¬¸êµ¬ í†µì¼ -->
        <div class="muted">
            <span th:if="${user != null}">
                (í˜„ì¬ ì‚¬ìš©ì: <b th:text="${user.name}">ì‚¬ìš©ì</b>)
            </span>
            <span th:if="${user == null}">
                (ë¡œê·¸ì¸ í›„ ê¸°ëŠ¥ì„ ì´ìš©í•  ìˆ˜ ìˆì–´ìš”)
            </span>
        </div>

        <!-- ë¡œê·¸ì¸ ìƒíƒœ: ë¡œê·¸ì•„ì›ƒë§Œ -->
        <div th:if="${user != null}">
            <form action="/logout" method="post">
                <button type="submit" class="btn outline">ë¡œê·¸ì•„ì›ƒ</button>
            </form>
        </div>

        <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ: ë¡œê·¸ì¸/íšŒì›ê°€ì… -->
        <div th:if="${user == null}">
            <a th:href="@{/login}">
                <button type="button" class="btn primary">ë¡œê·¸ì¸</button>
            </a>
            <a th:href="@{/register}">
                <button type="button" class="btn outline">íšŒì›ê°€ì…</button>
            </a>
        </div>

        <a th:if="${isAdmin}"
           th:href="@{/admin/dashboard}"
           style="
             position: fixed;
             top: 20px;
             right: 20px;
             font-size: 28px;
             text-decoration: none;
           "
           title="ê´€ë¦¬ì í˜ì´ì§€"
        >
            ğŸ› 
        </a>


        <!-- ê³µí†µ ê¸°ëŠ¥ -->
        <a th:href="@{/chat}">
            <button type="button" class="btn primary">ğŸ¤– ì±—ë´‡ ì´ìš©í•˜ê¸°</button>
        </a>

        <a th:href="@{/qr/loans}">
            <button type="button" class="btn gray">ğŸ“„ ëŒ€ì—¬ ëª©ë¡ ë³´ê¸°</button>
        </a>

        <a th:href="@{/help}">
            <button type="button" class="btn outline">ğŸ§‘â€ğŸ’¼ ê´€ë¦¬ì ë¬¸ì˜</button>
        </a>

        <div class="muted" style="margin-top:10px;">
            â€» ì‹¤ì œ â€œëŒ€ì—¬/ë°˜ë‚©â€ì€ ì±…ì— ë¶™ì€ QRë¡œ ì§„í–‰ë©ë‹ˆë‹¤.
        </div>
    </div>

    <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì—ê²Œë§Œ: ë‚´ ëŒ€ì—¬ í˜„í™© -->
    <div class="card" th:if="${user != null}">
        <h1 style="font-size:16px;">ğŸ“Œ ë‚´ ëŒ€ì—¬ í˜„í™©</h1>

        <div th:if="${#lists.isEmpty(loanViews)}" class="muted">
            í˜„ì¬ ëŒ€ì—¬ ì¤‘ì¸ ë„ì„œê°€ ì—†ìŠµë‹ˆë‹¤.
        </div>

        <div th:if="${!#lists.isEmpty(loanViews)}">
            <div class="muted">
                í˜„ì¬ <b th:text="${#lists.size(loanViews)}"></b>ê¶Œ ëŒ€ì—¬ ì¤‘ì…ë‹ˆë‹¤.
            </div>

            <div th:each="loan, iter : ${loanViews}" th:if="${iter.index < 2}">
                <div class="loan">
                    â€¢ <span th:text="${loan.title}"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì—ê²Œë§Œ: ë‚´ ë¬¸ì˜ -->
    <div class="card" th:if="${user != null}">
        <h1 style="font-size:16px;">ğŸ“¬ ë‚´ ë¬¸ì˜</h1>

        <div th:if="${inquiryCount == 0}" class="muted">
            ì•„ì§ ë¬¸ì˜í•œ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>

        <div th:if="${inquiryCount > 0}">
            ë¬¸ì˜ <b th:text="${inquiryCount}"></b>ê±´ <br>
            <div th:if="${unreadInquiryCount > 0}">
                ğŸ”” ìƒˆ ë‹µë³€ <b th:text="${unreadInquiryCount}"></b>ê±´
            </div>

            <div>
                <a th:href="@{/inquiries/my}" class="muted">
                    ë‚´ ë¬¸ì˜ ë‚´ì—­ ë³´ê¸° â†’
                </a>
            </div>
        </div>
    </div>

</div>
</body>
</html>
