<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê´€ë¦¬ì ë¬¸ì˜ ê´€ë¦¬</title>
    <style>
        .page-header {
            position: sticky;
            top: 0;
            background: #ffffff;
            z-index: 100;
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .back-btn {
            text-decoration: none;
            font-size: 14px;
            color: #2563eb;
            font-weight: bold;
        }
        .page-header h2 {
            margin: 0;
            font-size: 18px;
        }
    </style>
</head>
<body>

<h1>ğŸ“¨ ê´€ë¦¬ì ë¬¸ì˜ ê´€ë¦¬</h1>

<div class="page-header">
    <span th:if="${viewType == 'pending'}">â“ ë¯¸ì²˜ë¦¬ ë¬¸ì˜</span>
    <span th:if="${viewType == 'all'}">ğŸ“„ ì „ì²´ ë¬¸ì˜</span>
    <a th:href="@{/admin/dashboard}" class="back-btn">â† ê´€ë¦¬ì í—ˆë¸Œ</a>
</div>

<hr/>

<div th:if="${#lists.isEmpty(inquiries)}">
    <p th:if="${viewType == 'pending'}">ë¯¸ì²˜ë¦¬ ë¬¸ì˜ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ‰</p>
    <p th:if="${viewType == 'all'}">ë“±ë¡ëœ ë¬¸ì˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
</div>


<div th:each="inq : ${inquiries}"
     style="border:1px solid #ddd; padding:12px; margin-bottom:12px;">

    <p><b>ë¬¸ì˜ ID:</b> <span th:text="${inq.id}"></span></p>
    <p><b>ì‚¬ìš©ì:</b> <span th:text="${inq.user.name}"></span></p>
    <p><b>ë¬¸ì˜ ë‚´ìš©:</b></p>
    <p th:text="${inq.message}"></p>

    <div th:if="${inq.overdue}"
         style="background:#fee2e2; padding:8px;">
        âš ï¸ ì—°ì²´
        (<span th:text="${inq.overdueDays}"></span>ì¼ /
        <span th:text="${inq.penaltyAmount}"></span>ì›)
    </div>

    <p>
        ìƒíƒœ:
        <span th:text="${inq.resolved ? 'ì²˜ë¦¬ ì™„ë£Œ' : 'ë¯¸ì²˜ë¦¬'}"></span>
    </p>

    <p>
        ë¬¸ì˜ ì ‘ìˆ˜ ì‹œê°:
        <strong
                th:text="${#temporals.format(inq.createdAt, 'yyyy-MM-dd HH:mm')}">
        </strong>
    </p>

    <!-- ê´€ë¦¬ì ë‹µë³€ ì˜ì—­ -->
    <div th:if="${!inq.resolved}" style="margin-top:12px;">
        <form th:action="@{/admin/inquiries/{id}/reply(id=${inq.id})}"
              method="post"
              onsubmit="return confirm('ì´ ë‹µë³€ì„ ì €ì¥í•˜ê³  ë¬¸ì˜ë¥¼ ì²˜ë¦¬ ì™„ë£Œí• ê¹Œìš”?')">

            <label><b>ê´€ë¦¬ì ë‹µë³€</b></label><br/>
            <textarea name="reply"
                      rows="4"
                      style="width:100%; margin-top:6px;"
                      placeholder="ê´€ë¦¬ì ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”"
                      required></textarea>

            <button type="submit" style="margin-top:8px;">
                ë‹µë³€ ì €ì¥ & ì²˜ë¦¬ ì™„ë£Œ
            </button>
        </form>
    </div>

    <div th:if="${inq.resolved and inq.adminReply != null}"
         style="background:#f0f9ff; padding:10px; margin-top:10px;">
        <b>ê´€ë¦¬ì ë‹µë³€</b><br/>
        <p th:text="${inq.adminReply}"></p>
        <small th:text="${#temporals.format(inq.resolvedAt, 'yyyy-MM-dd HH:mm')}"></small>
    </div>

</div>

</body>
</html>
